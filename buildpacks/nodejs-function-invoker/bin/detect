#!/usr/bin/env bash
# shellcheck source-path=SCRIPTDIR/..

set -euo pipefail

app_dir=$(pwd)
build_plan="${2:?}"

# shellcheck source=/dev/null
source "${CNB_BUILDPACK_DIR}/utils/download.sh"
source "${CNB_BUILDPACK_DIR}/lib/detect.sh"

download_yj "$CNB_BUILDPACK_DIR"
export PATH=$CNB_BUILDPACK_DIR/downloads/bin:$PATH

if detect_function_app "${app_dir}"; then
	write_to_build_plan "${build_plan}"
	exit 0
fi

exit 100
